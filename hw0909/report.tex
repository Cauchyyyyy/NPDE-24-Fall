%!TEX program = xelatex
\documentclass{article}
\usepackage[UTF8,scheme=plain]{ctex}
\usepackage[a4paper,left=1.25in,right=1.25in,top=1in,bottom=1in]{geometry}

\usepackage{amsmath,amsthm,amsfonts,amssymb,listings}
\usepackage{graphicx}
\usepackage{float}
\usepackage{subcaption}
\usepackage{booktabs,multirow,multicol}
\usepackage{indentfirst}
\usepackage{hyperref}
\usepackage{setspace}
\usepackage{listings}
\usepackage[ruled,noline]{algorithm2e}
\usepackage{bm}
\usepackage{xcolor}




\title{NPDE~第1次实验报告}
\author{Author}
\date{\today}

\begin{document}

\maketitle

\section{Introduction}

$$v(x)=\frac{1}{2}(\pi-x),v_N(x)=\sum_{\omega =1}^{N}\frac{sin(\omega x)}{\omega},x \in \Omega=(0,2\pi]$$

将$\Omega$进行均匀剖分，$x_j=jh,j=1,2,\cdots,m,h=\frac{2\pi}{m},m=20,160$,对$v(x)$和$v_N(x)$绘制函数图像，

将$v_N(x)$修正为$$\widetilde{v}_N(x)=\sum_{\omega =1}^{N}\frac{sin(\frac{\omega \pi}{N})sin(\omega x)}{\frac{\omega \pi}{N}\omega} $$

重复上述操作

\section{Method}

$v(x)=\frac{1}{2}(\pi-x),v(x)=v(x+2\pi)$的Fourier级数的前N项为$v_N(x)=\sum_{\omega =1}^{N}\frac{sin(\omega x)}{\omega}$


\section{Results}

\begin{figure}[H]
    \centering
    \begin{subfigure}{0.35\textwidth}
        \includegraphics[width=\textwidth]{m=20,n=10.png}
        \caption{m=20,n=10}        
    \end{subfigure}
    \begin{subfigure}{0.35\textwidth}
        \includegraphics[width=\textwidth]{m=20,n=100.png}
        \caption{m=20,n=100}
    \end{subfigure}
    \begin{subfigure}{0.35\textwidth}
        \includegraphics[width=\textwidth]{m=160,n=10.png}
        \caption{m=160,n=10}
    \end{subfigure}
    \begin{subfigure}{0.35\textwidth}
        \includegraphics[width=\textwidth]{m=160,n=100.png}
        \caption{m=160,n=100}
    \end{subfigure}
    \caption{$v(x),v_N(x),\widetilde{v}_N(x)$的函数图像与误差}
\end{figure}



\section{Conclusion}

随着N的增大，$v_N(x)$趋近于$v(x)$，在$x=0$处出现Gibbs现象，修正后的函数$\widetilde{v}_N(x)$通过使Fourier系数随着$\omega$逐步减小，在$x=0$处振荡减弱


\section{Appendix}
\subsection{Program Discription}
本次作业使用matlab编写，打开pg1.m文件，运行即可得到结果，实现相关功能所需函数在resultshow.m文件中


\subsection{Code}
\lstinputlisting[language=Matlab]{pg1.m}
\lstinputlisting[language=Matlab]{resultshow.m}
\end{document}