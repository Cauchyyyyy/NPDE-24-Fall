%!TEX program = xelatex
\documentclass{article}
\usepackage[UTF8,scheme=plain]{ctex}
\usepackage[a4paper,left=1.25in,right=1.25in,top=1in,bottom=1in]{geometry}

\usepackage{amsmath,amsthm,amsfonts,amssymb}
\usepackage{graphicx}
\usepackage{float}
\usepackage{subcaption}
\usepackage{booktabs,multirow,multicol}
\usepackage{indentfirst}
\usepackage{hyperref}
\usepackage{setspace}
\usepackage{listings}
\usepackage[ruled,noline]{algorithm2e}
\usepackage{bm}
\usepackage{xcolor}

\title{NPDE~第2次实验报告}
\author{Author}
\date{\today}

\begin{document}

\maketitle

\section{Introduction}

求下述偏微分方程初值问题在时刻t=0.3的近似解：
$$
\begin{aligned}
  & u_t=u_x,-\infty<x<\infty,t>0 \\
  & u(x,0)=\sin(2\pi x)           \\
  & \text{周期为1}                  \\
\end{aligned}
$$

该方程的精确解为$u(x,t)=sin(2\pi(x+t))$，对时空区域均匀剖分如下：

时间：$t_n=n\times \Delta t,n=0,1,...,N$,时间步长$\Delta t=1/N$

空间：$x_j=j\times \Delta x,j=0,1,...,J$,空间步长$\Delta x=1/J$

取$\Delta x =0.02$，在$\Delta t=0.01,0.03$时，用FTFS，FTCS，FTBS方法求上述偏微分方程的近似解，并与准确解进行比较
\section{Method}

记近似解$v_j^n=u(x_j,t_n)$，近似方法分别为FTFS，FTBS，FTCS，分别得到离散方程为
$$v_j^{n+1}=v_j^n+\frac{\Delta t}{\Delta x}(v_{j+1}^n-v_{j}^n)$$
$$v_j^{n+1}=v_j^n+\frac{\Delta t}{\Delta x}(v_{j}^n-v_{j-1}^n)$$
$$v_j^{n+1}=v_j^n+\frac{\Delta t}{2\Delta x}(v_{j+1}^n-v_{j-1}^n)$$

定解条件：初始条件：$v_j^0=sin(2\pi j\Delta x)$，边界条件：$v_j^n=v_{j+J}^n$

构造矩阵存储结果。
\section{Results}

本次作业结果如下，其中u代表准确解，v代表近似解。

\begin{figure}[H]
  \centering
  \begin{subfigure}[b]{0.47\textwidth}
    \centering
    \includegraphics[width=\textwidth]{dt0.01.pdf}
    \caption{$dt=0.01$}

  \end{subfigure}
  \begin{subfigure}[b]{0.47\textwidth}
    \centering
    \includegraphics[width=\textwidth]{dt0.03.pdf}
    \caption{$dt=0.03$}

  \end{subfigure}
  \caption{FTFS, FTCS, FTBS method results}
\end{figure}
\section{Conclusion}
根据理论分析，FTFS的局部截断误差$O(\Delta t+\Delta x)$，FTBS的误差$O(\Delta t+\Delta x)$，
FTCS的误差$O(\Delta t+\Delta x^2)$，
求得的数值解与准确解有一定误差。

对于FTFS，$\hat{Q}=1+r(e^{i\omega \Delta x}-1)$
$$|\hat{Q}|\leq 1\Leftrightarrow (cos\xi-1)(1-r)\leq 0\leftrightarrow r\leq 1$$

数值解不是绝对稳定的

\section{Appendix}
\subsection{Code Discription}

本次作业使用python编写，打开main.py文件，运行即可得到结果.

特别地，由于$\Delta t=0.03$时无法对$[0,1]$进行均分，所以采用的区间为$[0,0.3]$，以保证函数的通用性

\subsection{Code}
\lstinputlisting[language=Python]{main.py}
\end{document}
